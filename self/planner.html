<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.6/prop-types.min.js"></script>
    <title>Document</title>
</head>

<body>
    <div id="root"></div>
    <script type="text/babel">

        const { useState, useRef, useCallback } = React;


        function CheckboxItem({ todo }) {
            const [checked, setChecked] = useState(false);

            const checkHandler = ({ target }) => {
                setChecked(!checked);
            };
            const style = {
                textDecoration: checked ? 'line-through' : 'none'
            };
            console.log(checked)
            const { id, text } = todo
            return (
                <div>
                    <input type="checkbox" checked={checked} onChange={({ target: { checked } }) => checkHandler(!checked)} />
                    <span style={style}>{text}</span>
                    <button>삭제</button>
                </div>
            )

        }


        function TodoList({ todos }) {

            return (
                <ul className="TodoList">
                    {todos.map((todo) => (
                        //key를 안넘기면 에러 발생
                        <CheckboxItem todo={todo} key={todo.id} />

                    ))}
                </ul>
            );
        }

        function Doinsert({ onInsert }) {
            const [value, setValue] = useState('');
            const onChange = useCallback(e => {
                setValue(e.target.value);
            }, [])
            //useCallback(생성하고 싶은 함수,[배열 안의 값이 바뀌었을 때 함수가 새로 생성됩니다.])
            const onSubmit = useCallback(
                e => {
                    onInsert(value);
                    setValue(''); // value 초기화
                    // 기본이벤트
                    e.preventDefault();
                }, [onInsert, value])
            console.log(value);
            return (         // html 태그 value 값 가져오는거 같음
                <form className="Doinsert" onSubmit={onSubmit}>
                    <input style={{ marginLeft: "20px" }} onChange={onChange} value={value} placeholder="할일을 입력해주세요" />
                    <button type="submit">추가하기</button>
                </form>
            )


        }

        function Board() {
            const [todos, setTodos] = useState([
            ]);
            const textStyle = {
                textAlign: "center",
                margin: "10px",
                color: "red"
            }
            const nextId = useRef(1); // 다시 랜더링 되어도 current 속성값을 유지
            const onInsert = useCallback(   //useCallback 특정 함수를 새로 만들지 않고 재사용하고 싶을 때 사용
                (text) => {
                    const todo = {
                        id: nextId.current,
                        text
                    };
                    setTodos((todos) => todos.concat(todo));// concat 인자로 주어진 배열이나 값들을 기존 배열에 합쳐서 새배열 반환
                    nextId.current++;
                }, [todos]);
            console.log(nextId);
            return (
                <>
                    <div style={{ width: 600, height: 500, border: '1px solid black' }}>
                        <div>
                            <div>
                                <h1 style={textStyle}>할일 리스트~~~~~</h1>
                                <TodoList todos={todos} />
                            </div>
                        </div>
                        <div>
                            <Doinsert onInsert={onInsert} />
                        </div>
                    </div>
                </>
            );
        }


        ReactDOM.createRoot(document.getElementById("root")).render(<Board />);
    </script>
</body>

</html>